defaultTasks 'dTask'


task tip {
	println 'Hello, Gradle!'
}


task dTask {
	println 'Hello, Groovy!'
}


task hello << {
	println 'Hello, World!'
}

hello.doFirst {
	println "I'm first."
}
hello.doLast {
	println "I'm last."
}
hello << {
	println "$hello.name Done!"
}


task upper << {
	String someString = 'mY_nAmE'
	println "Original: " + someString
	println "Upper Case: " + someString.toUpperCase()
}


task company << {
	print 'company: '
}

task google(dependsOn: company) << {
	println 'Google'
}


4.times { counter ->
	task "task$counter" << {
		println "I'm task number $counter"
	}
}

task3.dependsOn task0, task1, task2


task myTask {
	ext.myProperty = "myValue"
}

task printTaskProperty << {
	println myTask.myProperty
}


task loadFile << {
	def files = file('config').listFiles().sort()
	files.each { File file ->
		if (file.isFile()) {
			ant.loadfile(srcFile: file, property: file.name)
			println "*** $file.name ***"
			println "${ant.properties[file.name]}"
		}
	}
}


task loadFile2 << {
	fileList('config').each { File file ->
		ant.loadfile(srcFile: file, property: file.name)
		println "*** $file.name ***"
		println "${ant.properties[file.name]}"
	}
}

File[] fileList(String dir) {
	file(dir).listFiles({ file -> file.isFile() } as FileFilter).sort()
}


task distribution << {
	println "Building version $version"
}

task release(dependsOn: 'distribution') << {
	println 'Release'
}

gradle.taskGraph.whenReady { taskGraph ->
	if (taskGraph.hasTask(release)) {
		version = '1.0'
	}
	else {
		version = '0.1'
	}
}
